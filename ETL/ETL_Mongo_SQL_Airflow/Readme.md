Проект ETL (Extract, Transform, Load) конвейера данных, оркестрируемого с помощью Apache Airflow. Система извлекает данные из MongoDB, трансформирует их с помощью Python и загружает в PostgreSQL для дальнейшего анализа.

Архитектура системы

Проект состоит из следующих компонентов:

    MongoDB - источник данных, хранящий информацию в трех коллекциях:
        UserSessions - данные о сессиях пользователей
        SupportTickets - данные о тикетах поддержки
        ProductPriceHistory - история изменения цен на продукты

    PostgreSQL - целевое хранилище данных с реляционной структурой и аналитическими витринами

    Apache Airflow - система оркестрации, управляющая ETL-процессом

Основные компоненты

    mongo_generator.py - класс для генерации тестовых данных в MongoDB
    postgres_migrator.py - класс для создания таблиц в PostgreSQL и миграции данных из MongoDB
    data_warehouse.py - класс для создания аналитических витрин на основе данных в PostgreSQL
    airflow_pipeline.py - класс для управления ETL-процессом в Airflow
    main.py - скрипт для запуска ETL-процесса вне Airflow (для тестирования)
    etl_pipeline_dag.py - DAG-файл для Airflow, определяющий последовательность задач ETL-процесса


Установка и запуск
1. Клонирование репозитория

2. Запуск контейнеров Docker

docker compose -f Docker_Files/docker-compose.yml up -d

3. Доступ к интерфейсам

    Airflow: http://localhost:8080 (логин: admin, пароль: admin)
    Mongo Express: http://localhost:8081
    PostgreSQL: localhost:5432 (пользователь: admin, пароль: admin)

Запуск ETL-процесса
Через Airflow

    Откройте веб-интерфейс Airflow по адресу http://localhost:8080
    Найдите DAG с именем etl_mongo_to_postgres
    Активируйте DAG, нажав на переключатель
    Запустите DAG, нажав на кнопку "Trigger DAG"

**Вручную (для тестирования)**

python main.py

Описание ETL-процесса

ETL-процесс состоит из следующих этапов:

    Генерация данных в MongoDB
        Создание тестовых данных в коллекциях UserSessions, SupportTickets и ProductPriceHistory

    Создание таблиц в PostgreSQL
        Создание таблиц users, user_sessions, support_tickets и product_price_history

    Генерация пользователей в PostgreSQL
        Создание тестовых пользователей для связи с другими таблицами

    Миграция данных из MongoDB в PostgreSQL
        Перенос данных из коллекций MongoDB в соответствующие таблицы PostgreSQL

    Создание аналитических витрин
        Создание витрины активности пользователей (user_activity_mart)
        Создание витрины эффективности поддержки (support_efficiency_mart)
        Создание витрины аналитики цен на продукты (product_price_analytics_mart)

Аналитические витрины
1. Витрина активности пользователей (user_activity_mart)

Содержит агрегированные данные о сессиях пользователей:

    Общее количество сессий
    Средняя продолжительность сессии
    Общее количество посещенных страниц
    Последняя активность
    Распределение устройств (мобильные, десктоп, планшеты)

2. Витрина эффективности поддержки (support_efficiency_mart)

Содержит агрегированные данные о тикетах поддержки:

    Общее количество тикетов по типам проблем
    Среднее время разрешения
    Количество открытых и закрытых тикетов
    Распределение времени ответа

3. Витрина аналитики цен на продукты (product_price_analytics_mart)

Содержит агрегированные данные о ценах на продукты:

    Средняя цена по валютам
    Минимальная и максимальная цены
    Частота изменения цен

